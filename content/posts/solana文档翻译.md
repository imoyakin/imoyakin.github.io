---
title: "solanaæ–‡æ¡£ç¿»è¯‘"
date: 2022-08-11T13:26:57+08:00
draft: true
---

# Cluster

ä¸€ä¸ªsolanaé›†ç¾¤æ˜¯ä¸€ç¾¤éªŒè¯å™¨çš„é›†åˆ,ä»–ä»¬ä¸ºå®¢æˆ·æä¾›äº¤æ˜“å¹¶ç»´æŠ¤è´¦æœ¬æ­£ç¡®æ€§çš„æœåŠ¡.è®¸å¤šé›†ç¾¤å¯ä»¥å…±å­˜.å½“ä¸¤ä¸ªé›†ç¾¤å…±äº«ç›¸åŒçš„åˆ›ä¸–å—çš„æ—¶å€™,å®ƒä»¬ä¼šå°è¯•æ”¶æ•›,å¦åˆ™ä»–ä»¬ä¼šç®€å•çš„å¿½ç•¥æ‰å½¼æ­¤,å‘é€ç»™é”™è¯¯èŠ‚ç‚¹çš„äº¤æ˜“ä¼šè¢«æ‚„æ‚„çš„æ‹’ç»æ‰.åœ¨è¿™ä¸€èŠ‚,æˆ‘ä»¬ä¼šè®¨è®º,å¦‚ä½•åˆ›å»ºé›†ç¾¤,å¦‚ä½•è®©èŠ‚ç‚¹åŠ å…¥é›†ç¾¤,å®ƒä»¬æ˜¯æ€ä¹ˆå…±äº«è´¦æœ¬ã€ç¡®ä¿è´¦æœ¬è¢«å¤åˆ¶,å¦‚ä½•å¯¹æŠ—æœ‰ç¼ºé™·æˆ–è€…æ¶æ„çš„èŠ‚ç‚¹.

## åˆ›å»ºé›†ç¾¤
åœ¨å¯åŠ¨ä»»ä½•éªŒè¯å™¨é’±,é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªåˆ›ä¸–é…ç½®.è¿™ä¸ªé…ç½®åŒ…å«ä¸¤ä¸ªå…¬é’¥:ä¸€ä¸ªé“¸å¸å‚å¯†é’¥å’Œå¼•å¯¼éªŒè¯å™¨è¿·è¯.æŒæœ‰å¼•å¯¼éªŒè¯å…¶å¯†é’¥çš„éªŒè¯å™¨ä¼šè´Ÿè´£å°†ç¬¬ä¸€ä¸ªentryåŠ å…¥è´¦æœ¬.å®ƒä½¿ç”¨é“¸å¸å‚è´¦æˆ·åˆå§‹åŒ–å†…éƒ¨çŠ¶æ€.è¿™ä¸ªè´¦æˆ·ä¼šæŒæœ‰åˆ›ä¸–æ—¶å®šä¹‰çš„åŸç”Ÿä»£å¸æ•°é‡.ç¬¬äºŒä¸ªéªŒè¯å™¨è¿æ¥å¼•å¯¼éªŒè¯å™¨æ³¨å†Œä¸ºä¸€ä¸ªéªŒè¯å™¨å,å…¶ä½™æ–°åŠ å…¥éªŒè¯å™¨è¿æ¥é›†ç¾¤ä¸­çš„ä»»ä½•ä¸€ä¸ªéªŒè¯å™¨æ³¨å†ŒåŠ å…¥.

éªŒè¯è€…ä»é¢†å¯¼è€…é‚£é‡Œæ¥æ”¶æ‰€æœ‰çš„æ¡ç›®å¹¶æäº¤ç¡®è®¤æ¡ç›®æœ‰æ•ˆçš„æŠ•ç¥¨.æŠ•ç¥¨å,éªŒè¯è€…åº”å½“å­˜å‚¨è¿™äº›æ¡ç›®.å½“éªŒè¯è€…è§‚å¯Ÿåˆ°è¶³å¤Ÿæ•°é‡çš„å‰¯æœ¬å­˜åœ¨,å°±ä¼šåˆ é™¤è‡ªå·±çš„å‰¯æœ¬.

## åŠ å…¥ä¸€ä¸ªé›†ç¾¤

éªŒè¯è€…é€šè¿‡å‘é€å…¶æ§åˆ¶å±‚é¢çš„ä¿¡æ¯æ¥åŠ å…¥é›†ç¾¤.å…¶æ§åˆ¶å±‚é¢æ˜¯é€šè¿‡gossip(ç•™è¨€)åè®®å®ç°çš„,è¿™æ„å‘³ç€ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥å’Œä»»æ„èŠ‚ç‚¹æ³¨å†Œ,å¹¶æœŸå¾…å…¶æ³¨å†Œä¿¡æ¯ä¼ æ’­åˆ°é›†ç¾¤çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹.åŒæ­¥æ‰€æ¶ˆè€—çš„æ—¶é—´ä¸å‚ä¸é›†ç¾¤æ²»ç†çš„èŠ‚ç‚¹æ•°é‡çš„å¹³æ–¹æˆæ­£æ¯”.ä»ç®—æ³•ä¸Š,è¿™è¢«è®¤ä¸ºéå¸¸ç¼“æ…¢.ä½†ä½œä¸ºäº¤æ¢,ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥ç¡®ä¿¡æ‹¥æœ‰å’Œå…¶ä»–èŠ‚ç‚¹ç›¸åŒçš„ä¿¡æ¯,ä¸”ä¿¡æ¯ä¸ä¼šè¢«ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹å®¡æŸ¥.

## å°†äº¤æ˜“å‘é€ç»™ä¸€ä¸ªé›†ç¾¤

å®¢æˆ·ç«¯å°†äº¤æ˜“å‘é€ç»™ä»»æ„éªŒè¯å™¨çš„TPU(Transaction Proccessing Unit äº¤æ˜“å¤„ç†å•å…ƒ)ç«¯å£.
å¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ˜¯æ˜¯éªŒè¯å™¨è§’è‰²,å®ƒä¼šå°†äº¤æ˜“è½¬å‘ç»™åˆ¶å®šçš„é¢†å¯¼è€….
å¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ˜¯é¢†å¯¼è€…è§’è‰²,å®ƒä¼šæ‰“åŒ…ä¼ å…¥çš„äº¤æ˜“,ä¸ºè¿™äº›äº¤æ˜“æ·»åŠ æ—¶é—´æˆ³åˆ›å»ºæ¡ç›®,ç„¶åå°†å…¶æ¨é€åˆ°é›†ç¾¤çš„æ•°æ®å±‚é¢. ä¸€æ—¦æ•°æ®è½å…¥æ•°æ®å±‚é¢,æ•°æ®ä¸­çš„äº¤æ˜“ä¼šè¢«èŠ‚ç‚¹éªŒè¯,å¹¶æœ‰æ•ˆçš„åŠ å…¥åˆ°è´¦æœ¬ä¸­.

## ç¡®è®¤äº¤æ˜“

ä¸€ä¸ªsolanaé›†ç¾¤èƒ½åœ¨ä¸Šåƒä¸ªèŠ‚ç‚¹çš„æƒ…å†µä¸‹å®ç°äºšç§’çº§æ‰©å®¹,å¹¶è®¡åˆ’æ‰©å±•åˆ°åä¸‡ä¸ªèŠ‚ç‚¹.ç¡®è®¤æ—¶é—´åªä¼šéšç€éªŒè¯èŠ‚ç‚¹çš„å¢åŠ è€Œå¯¹æ•°å¢åŠ ,åŒæ—¶å¯¹æ•°çš„åŸºæ•°éå¸¸é«˜.ä¸¾ä¸ªä¾‹å­ğŸŒ°:å¦‚æœè¿™ä¸ªåŸºæ•°æ˜¯1000, æ„å‘³ç€å¯¹äºå‚ä¸ç¡®è®¤çš„å‰1000ä¸ªç½‘ç»œèŠ‚ç‚¹,ç¡®è®¤äº¤æ˜“çš„å‘¨æœŸå°†æ˜¯ä¸‰ä¸ªç½‘ç»œè·ƒç‚¹æ—¶é—´åŠ ä¸Šç»å¯¹å¤šæ•°ç¥¨ä¸­æœ€æ…¢çš„éªŒè¯è€…. å¯¹äºä¸‹ä¸ªç™¾ä¸‡æ•°é‡çš„èŠ‚ç‚¹,éªŒè¯æ—¶é—´çš„å¢åŠ åªæ˜¯ä¸€ä¸ªç½‘ç»œè·ƒç‚¹æ—¶é—´.

Solana defines confirmation as the duration of time from when the leader timestamps a new entry to the moment when it recognizes a supermajority of ledger votes.

å¯ä»¥ä½¿ç”¨æ··åˆå¦‚ä¸‹æŠ€æœ¯æ¥å®ç°å¯¹æ‰©å±•çš„ç¡®è®¤:
    1. å¸¦æœ‰ VDF æ ·æœ¬çš„æ—¶é—´æˆ³äº¤æ˜“å¹¶ç­¾ç½²æ—¶é—´æˆ³.
    2. å°†äº¤æ˜“åˆ†æˆæ‰¹æ¬¡ï¼Œå°†æ¯ä¸ªæ‰¹æ¬¡å‘é€åˆ°å•ç‹¬çš„èŠ‚ç‚¹ï¼Œå¹¶è®©æ¯ä¸ªèŠ‚ç‚¹ä¸å…¶å¯¹ç­‰èŠ‚ç‚¹å…±äº«å…¶æ‰¹æ¬¡.
    3. é€’å½’åœ°é‡å¤ä¸Šä¸€æ­¥ï¼Œç›´åˆ°æ‰€æœ‰èŠ‚ç‚¹éƒ½æœ‰æ‰€æœ‰æ‰¹æ¬¡.

solanaå®šæœŸçš„è½®æ¢é¢†å¯¼è€…,è¿™ç§è¡Œä¸ºè¢«ç§°ä½œ slots. æ¯ä¸ªé¢†å¯¼è€…åªåœ¨å…¶åˆ†é…çš„slotsé‡Œäº§ç”Ÿæ¡ç›®(entries). å› æ­¤é¢†å¯¼è€…åœ¨äº¤æ˜“ä¸Šæ ‡è®°æ—¶é—´æˆ³è®©éªŒè¯è€…æŸ¥æ‰¾é¢†å¯¼è€…çš„å…¬é’¥.é¢†å¯¼è€…åœ¨æ—¶é—´æˆ³ä¼¤ç­¾åä»¥ä¾¿éªŒè¯ç€éªŒè¯,ä»¥è¯æ˜ç­¾åè€…æ˜¯é¢†å¯¼è€…çš„å…¬é’¥æ‰€ç­¾.

æ¥ä¸‹æ¥,äº¤æ˜“è¢«å‘é€ç»™å‡ ä¸ªæ‰¹æ¬¡ä»¥ä¾¿èŠ‚ç‚¹å‘é€äº¤æ˜“ç»™å¤šæ–¹æ—¶ä¸éœ€è¦åˆ¶ä½œå¤šä¸ªå‰¯æœ¬.ä¸¾ä¸ªä¾‹å­ğŸŒ°:å¦‚æœé¢†å¯¼è€…éœ€è¦å‘ 6 ä¸ªèŠ‚ç‚¹å‘é€ 60 ä¸ªäº‹åŠ¡ï¼Œå®ƒä¼šå°† 60 ä¸ªäº‹åŠ¡çš„é›†åˆåˆ†æˆ 10 ä¸ªäº‹åŠ¡çš„æ‰¹æ¬¡ï¼Œç„¶åå‘æ¯ä¸ªèŠ‚ç‚¹å‘é€ä¸€ä¸ªã€‚è¿™å…è®¸é¢†å¯¼è€…åœ¨ç½‘ç»œä¸Šæ”¾ç½® 60 ä¸ªäº‹åŠ¡ï¼Œè€Œä¸æ˜¯æ¯ä¸ªèŠ‚ç‚¹çš„ 60 ä¸ªäº‹åŠ¡ã€‚ç„¶åæ¯ä¸ªèŠ‚ç‚¹ä¸å…¶å¯¹ç­‰èŠ‚ç‚¹å…±äº«å…¶æ‰¹æ¬¡ã€‚ä¸€æ—¦èŠ‚ç‚¹æ”¶é›†äº†æ‰€æœ‰ 6 ä¸ªæ‰¹æ¬¡ï¼Œå®ƒå°±ä¼šé‡å»ºåŸå§‹çš„ 60 ä¸ªäº¤æ˜“é›†ã€‚

ä¸€æ‰¹äº¤æ˜“åªæœ‰ç»å†è¿‡è¶³å¤Ÿçš„æ¬¡æ‹†åˆ†,æ‰èƒ½ä½¿å…¶ç¬‘åˆ°è®©å…¶å¤´ä¿¡æ¯æˆä¸ºç½‘ç»œå¸¦å®½çš„ä¸»è¦æ¶ˆè´¹è€…. ä¸ºäº†å°†èŠ‚ç‚¹æ‰©å±•åˆ°æ•°åä¸‡ä¸ªéªŒè¯è€…,æ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥ä¸ä¸»èŠ‚ç‚¹ç›¸åŒçš„æŠ€æœ¯æ–¹å¼æ‰©å±•åˆ°å¦ä¸€ç»„ç›¸åŒå¤§å°çš„èŠ‚ç‚¹.æˆ‘ä»¬å«è¿™ä¸ªæŠ€æœ¯ä¸º â€œæ¶¡è½®å—ä¼ æ’­â€œ.

# åŒæ­¥

å¿«é€Ÿ,å¯é çš„åŒæ­¥æ˜¯solanaèƒ½å®ç°å¦‚æ­¤é«˜ååçš„ä¸»è¦åŸå› .ä¼ ç»Ÿçš„åŒºå—é“¾åœ¨ä¸€ä¸ªå«åš blocksçš„å¤§å—äº¤æ˜“ä¸Šè¿›è¡ŒåŒæ­¥.é€šè¿‡å—åŒæ­¥,çŸ¥é“ç»è¿‡è¢«ç§°ä¸ºâ€œå—æ—¶é—´â€çš„åŒºå—æ‰èƒ½å¤„ç†äº¤æ˜“.åœ¨å·¥ä½œé‡è¯æ˜å…±è¯†ä¸‹,è¿™ä¸ªå—æ—¶é—´éœ€è¦éå¸¸å¤§(çº¦10min)ä»¥å°½é‡å‡å°‘å¤§é‡éªŒè¯è€…åœ¨åŒä¸€æ—¶åˆ»å£°ç§°æ–°çš„æœ‰æ•ˆå—çš„å‡ ç‡.åœ¨è´¨æŠ¼è¯æ˜å…±è¯†ä¸‹æ²¡æœ‰è¿™æ ·çš„é™åˆ¶,ä½†æ˜¯å¤±å»äº†å¯é çš„æ—¶é—´æˆ³,ä¸€ä¸ªéªŒè¯ç€å°†æ— æ³•ç¡®å®šä¼ å…¥å—çš„é¡ºåº.æµè¡Œçš„è§£å†³æ–¹æ¡ˆæ˜¯ç”¨æŒ‚é’Ÿæ—¶é—´æˆ³æ ‡è®°æ¯ä¸ªå—. å› ä¸ºæ—¶é’Ÿæ¼‚æµå’Œç½‘ç»œå»¶è¿Ÿçš„åŸå› ,æ—¶é—´æˆ³åªèƒ½åœ¨ä¸€ä¸¤ä¸ªå°æ—¶å†…å‡†ç¡®.ä¸ºäº†è§£å†³è¿™ä¸ªè§£å†³æ–¹æ¡ˆå¸¦æ¥çš„éº»çƒ¦,ç³»ç»Ÿé€šå¸¸ä¼šå»¶é•¿åŒºå—æ—¶é—´,æä¾›åˆç†çš„å‡†ç¡®æ€§,ä»¥ç¡®ä¿æ¯ä¸ªåŒºå—çš„æ—¶é—´æˆ³åœ¨å¢é•¿.

solanaä½¿ç”¨äº†æˆªç„¶ä¸åŒçš„æ–¹æ³•,è¿™ä¸ªè¢«ç§°ä¸ºåŸºäºå†å²çš„è¯æ˜(POH).é¢†å¯¼èŠ‚ç‚¹çš„æ—¶é—´æˆ³åŒºå—å’Œå…¶åŠ å¯†è¯æ˜åˆ°æœ€åä¸€ä¸ªè¯æ˜ç»è¿‡äº†ä¸€æ®µæ—¶é—´.æ‰€æœ‰çš„è¯æ˜ä¸­æ•°æ®çš„å“ˆå¸Œè‚¯å®šæ˜¯åœ¨è¯æ˜ä¹‹å‰äº§ç”Ÿ.è¯¥èŠ‚ç‚¹ä¸èƒ½å¤ŸéªŒè¯è¿™äº›è¯æ˜çš„éªŒè¯èŠ‚ç‚¹å…±äº«æ–°å—. è¿™äº›å—å¯ä»¥ä»¥ä»»ä½•é¡ºåºåˆ°è¾¾éªŒè¯è€…ï¼Œç”šè‡³å¯ä»¥åœ¨æ•°å¹´åé‡æ’­ã€‚ æœ‰äº†è¿™ç§å¯é çš„åŒæ­¥ä¿è¯ï¼ŒSolana èƒ½å¤Ÿå°†å—åˆ†æˆæ›´å°çš„äº‹åŠ¡æ‰¹æ¬¡ï¼Œç§°ä¸ºæ¡ç›®(entries). åœ¨ä»»ä½•åŒºå—å…±è¯†æ¦‚å¿µä¹‹å‰ï¼Œæ¡ç›®(entries)ä¼šå®æ—¶æµå¼ä¼ è¾“åˆ°éªŒè¯å™¨ã€‚

Leader nodes "timestamp" blocks with cryptographic proofs that some duration of time has passed since the last proof. All data hashed into the proof most certainly have occurred before the proof was generated. The node then shares the new block with validator nodes, which are able to verify those proofs. The blocks can arrive at validators in any order or even could be replayed years later. With such reliable synchronization guarantees, Solana is able to break blocks into smaller batches of transactions called entries. Entries are streamed to validators in realtime, before any notion of block consensus.

SolanaæŠ€æœ¯ä¸Šçš„æ¥è¯´ä»æœªå‘é€ä»»ä½•ä¸€ä¸ªå—ï¼Œ ä½†æ˜¯å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼æ¥æè¿°solanaéªŒè¯å™¨ä¹‹é—´æŠ•ç¥¨ç¡®è®¤çš„è¿‡ç¨‹.In that way, Solana's confirmation times can be compared apples to apples to block-based systems. å½“å‰çš„å®ç°ä¸‹å—æ—¶é—´æ˜¯800ms.

Solana technically never sends a block, but uses the term to describe the sequence of entries that validators vote on to achieve confirmation. In that way, Solana's confirmation times can be compared apples to apples to block-based systems. The current implementation sets block time to 800ms.

èƒŒåå‘ç”Ÿçš„æ•…äº‹æ—¶,åªè¦é¢†å¯¼èŠ‚ç‚¹å°†ä¸€ç»„æœ‰æ•ˆçš„äº¤æ˜“æ‰¹å¤„ç†åˆ°ä¸€ä¸ªæ¡ç›®ä¸­,æ¡ç›®å°±ä¼šè¢«æµå¼ä¼ è¾“åˆ°éªŒè¯å…¶. éªŒè¯å™¨åœ¨å¯¹ä»–ä»¬çš„æœ‰æ•ˆæ€§è¿›è¡ŒæŠ•ç¥¨å¾ˆä¹…ä¹‹å‰å°±è¿›è¡Œäº†å¤„ç†. é€šè¿‡ä¹è§‚çš„å¤„ç†è¿™äº›äº¤æ˜“, æœ€åä¸€ä¸ªæ”¶åˆ°äº¤æ˜“çš„èŠ‚ç‚¹å¯ä»¥æ²¡æœ‰å»¶è¿Ÿçš„å¼€å§‹æŠ•ç¥¨. å¦‚æœæ²¡æœ‰è¾¾æˆå…±è¯†,é‚£ä¹ˆèŠ‚ç‚¹ä¼šç®€å•çš„å›æ»šå…¶çŠ¶æ€. è¿™ç§ä¹è§‚å¤„ç†æŠ€æœ¯åœ¨1981å¹´è¢«æå‡º,è¢«ç§°ä¸ºä¹è§‚å¹¶å‘æ§åˆ¶.å®ƒå¯ä»¥è¢«åº”ç”¨åˆ°åŒºå—é“¾ä¸­, ä»¥é›†ç¾¤çš„æ–¹å¼å¯¹ä»£è¡¨äº†å®Œæ•´è´¦æœ¬çš„å“ˆå¸Œè¿›è¡ŒæŠ•ç¥¨,ç›´åˆ°æŠµè¾¾æŸä¸ªé«˜åº¦.åœ¨solanaä¸­,å®ƒä½¿ç”¨æœ€åä¸€ä¸ªæ¡ç›®çš„PoHå“ˆå¸Œæ¥ç®€å•çš„å®ç°.

What's happening under the hood is that entries are streamed to validators as quickly as a leader node can batch a set of valid transactions into an entry. Validators process those entries long before it is time to vote on their validity. By processing the transactions optimistically, there is effectively no delay between the time the last entry is received and the time when the node can vote. In the event consensus is not achieved, a node simply rolls back its state. This optimisic processing technique was introduced in 1981 and called Optimistic Concurrency Control. It can be applied to blockchain architecture where a cluster votes on a hash that represents the full ledger up to some block height. In Solana, it is implemented trivially using the last entry's PoH hash.

## ä¸VDFä¹‹é—´çš„å…³ç³»
## Relationship to VDFs#

åŸºäºå†å²çš„è¯æ˜çš„æŠ€æœ¯ä¸ºäº†ä½¿ç”¨åœ¨solanaåŒºå—é“¾ä¸Šç¬¬ä¸€æ¬¡æå‡ºæ˜¯åœ¨2017å¹´çš„11çº¦.ç¬¬äºŒå¹´çš„å…­æœˆ,æ–¯å¦ç¦å¤§å­¦æå‡ºäº†ä¸€ä¸ªå«åšçš„VDF(å¯å»¶è¿Ÿè¯æ˜å‡½æ•°)çš„ç›¸ä¼¼æŠ€æœ¯.

The Proof of History technique was first described for use in blockchain by Solana in November of 2017. In June of the following year, a similar technique was described at Stanford and called a verifiable delay function or VDF.


VDF çš„ä¸€ä¸ªç†æƒ³ç‰¹æ€§æ˜¯éªŒè¯æ—¶é—´éå¸¸å¿«ã€‚ Solana éªŒè¯å…¶å»¶è¿Ÿå‡½æ•°çš„æ–¹æ³•ä¸åˆ›å»ºå®ƒæ‰€èŠ±è´¹çš„æ—¶é—´æˆæ­£æ¯”ã€‚é€šè¿‡æ‹†åˆ†æˆ 4000 æ ¸ GPUçš„ä»»åŠ¡ï¼Œå®ƒçš„é€Ÿåº¦è¶³ä»¥æ»¡è¶³ Solana çš„éœ€æ±‚ï¼Œä½†å¦‚æœä½ é—®ä¸Šé¢å¼•ç”¨çš„è®ºæ–‡çš„ä½œè€…ï¼Œä»–ä»¬å¯èƒ½ä¼šå‘Šè¯‰ä½ ï¼ˆå¹¶ä¸”æœ‰ï¼‰Solana çš„æ–¹æ³•åœ¨ç®—æ³•ä¸Šå¾ˆæ…¢ï¼Œä¸åº”è¯¥è¢«ç§°ä¸º VDF .æˆ‘ä»¬è®¤ä¸º VDF ä¸€è¯åº”è¯¥ä»£è¡¨å¯éªŒè¯å»¶è¿Ÿå‡½æ•°çš„ç±»åˆ«ï¼Œè€Œä¸ä»…ä»…æ˜¯å…·æœ‰æŸäº›æ€§èƒ½ç‰¹å¾çš„å­é›†ã€‚åœ¨è§£å†³è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼ŒSolana å¯èƒ½ä¼šç»§ç»­ä½¿ç”¨ PoH ä¸€è¯æ¥è¡¨ç¤ºå…¶ç‰¹å®šäºåº”ç”¨ç¨‹åºçš„ VDFã€‚
A desirable property of a VDF is that verification time is very fast. Solana's approach to verifying its delay function is proportional to the time it took to create it. Split over a 4000 core GPU, it is sufficiently fast for Solana's needs, but if you asked the authors of the paper cited above, they might tell you (and have) that Solana's approach is algorithmically slow and it shouldn't be called a VDF. We argue the term VDF should represent the category of verifiable delay functions and not just the subset with certain performance characteristics. Until that's resolved, Solana will likely continue using the term PoH for its application-specific VDF.

PoH å’Œ VDF ä¹‹é—´çš„å¦ä¸€ä¸ªåŒºåˆ«æ˜¯ VDF ä»…ç”¨äºè·Ÿè¸ªæŒç»­æ—¶é—´ã€‚ä¸€æ–¹é¢ï¼ŒPoH çš„å“ˆå¸Œé“¾åŒ…æ‹¬åº”ç”¨ç¨‹åºè§‚å¯Ÿåˆ°çš„ä»»ä½•æ•°æ®çš„å“ˆå¸Œå€¼ã€‚è¿™äº›æ•°æ®æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ã€‚ä¸€æ–¹é¢ï¼Œæ•°æ®â€œè¯æ˜äº†å†å²â€â€”â€”æ•°æ®è‚¯å®šå­˜åœ¨äºå®ƒä¹‹åçš„æ•£åˆ—ä¹‹å‰ã€‚å¦ä¸€æ–¹é¢ï¼Œè¿™æ„å‘³ç€åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡æ›´æ”¹æ•°æ®æ•£åˆ—çš„æ—¶é—´æ¥æ“çºµæ•£åˆ—é“¾ã€‚å› æ­¤ï¼ŒPoH é“¾ä¸èƒ½ä½œä¸ºéšæœºæ€§çš„è‰¯å¥½æ¥æºï¼Œè€Œæ²¡æœ‰è¯¥æ•°æ®çš„ VDF åˆ™å¯ä»¥ã€‚ä¾‹å¦‚ï¼ŒSolana çš„é¢†å¯¼è€…æ—‹è½¬ç®—æ³•ä»…æ¥è‡ª VDF é«˜åº¦ï¼Œè€Œä¸æ˜¯å…¶åœ¨è¯¥é«˜åº¦çš„å“ˆå¸Œå€¼ã€‚
Another difference between PoH and VDFs is that a VDF is used only for tracking duration. PoH's hash chain, on the other hand, includes hashes of any data the application observed. That data is a double-edged sword. On one side, the data "proves history" - that the data most certainly existed before hashes after it. On the other side, it means the application can manipulate the hash chain by changing when the data is hashed. The PoH chain therefore does not serve as a good source of randomness whereas a VDF without that data could. Solana's leader rotation algorithm, for example, is derived only from the VDF height and not its hash at that height.

## Relationship to Consensus Mechanisms#
## ä¸å…±è¯†æœºåˆ¶çš„å…³ç³»
åŸºäºå†å²çš„è¯æ˜ä¸æ˜¯ä¸€ä¸ªå…±è¯†æœºåˆ¶,å®ƒåªæ˜¯ç”¨æ¥æé«˜solana åŸºäºè´¨æŠ¼å…±è¯†æœºåˆ¶çš„æ€§èƒ½å’Œæ•°æ®ä¼ è¾“æ€§èƒ½çš„ä¸€ç§æ‰‹æ®µ.
Proof of History is not a consensus mechanism, but it is used to improve the performance of Solana's Proof of Stake consensus. It is also used to improve the performance of the data plane protocols.

## é¢†å¯¼è€…è½®æ¢
## Leader Rotation
åœ¨ç»™å®šçš„ä»»æ„æ—¶åˆ», ä¸€ä¸ªé›†ç¾¤éƒ½å¸Œæœ›åªæœ‰ä¸€ä¸ªéªŒè¯è€…å»å¤„ç†è´¦æœ¬æ¡ç›®. é€šè¿‡ä¸€æ¬¡åªæœ‰ä¸€ä¸ªé¢†å¯¼è€…ï¼Œæ‰€æœ‰éªŒè¯è€…éƒ½èƒ½å¤Ÿé‡æ”¾ç›¸åŒçš„åˆ†ç±»è´¦å‰¯æœ¬.ç„¶è€Œï¼Œä¸€æ¬¡åªæœ‰ä¸€ä¸ªé¢†å¯¼è€…çš„ç¼ºç‚¹æ˜¯ï¼Œä¸€ä¸ªæ¶æ„çš„é¢†å¯¼è€…èƒ½å¤Ÿå®¡æŸ¥æŠ•ç¥¨å’Œäº¤æ˜“ã€‚ç”±äºå®¡æŸ¥æ— æ³•ä¸ç½‘ç»œä¸¢å¼ƒæ•°æ®åŒ…åŒºåˆ†å¼€æ¥ï¼Œé›†ç¾¤ä¸èƒ½ç®€å•åœ°é€‰å‡ºä¸€ä¸ªèŠ‚ç‚¹æ— é™æœŸåœ°æ‹…ä»»é¢†å¯¼è€…çš„è§’è‰².ç›¸åï¼Œé›†ç¾¤é€šè¿‡è½®æ¢å“ªä¸ªèŠ‚ç‚¹æ¥æœ€å¤§é™åº¦åœ°å‡å°‘æ¶æ„é¢†å¯¼è€…çš„å½±å“.
At any given moment, a cluster expects only one validator to produce ledger entries. By having only one leader at a time, all validators are able to replay identical copies of the ledger. The drawback of only one leader at a time, however, is that a malicious leader is capable of censoring votes and transactions. Since censoring cannot be distinguished from the network dropping packets, the cluster cannot simply elect a single node to hold the leader role indefinitely. Instead, the cluster minimizes the influence of a malicious leader by rotating which node takes the lead.

æ¯ä¸ªéªŒè¯è€…ä½¿ç”¨ç›¸åŒçš„ç®—æ³•é€‰æ‹©é¢„æœŸçš„é¢†å¯¼è€…ï¼Œå¦‚ä¸‹æ‰€è¿°ã€‚å½“éªŒè¯è€…æ”¶åˆ°ä¸€ä¸ªæ–°çš„ç­¾ååˆ†ç±»è´¦æ¡ç›®æ—¶ï¼Œå®ƒå¯ä»¥ç¡®å®šæ¡ç›®æ˜¯ç”±é¢„æœŸçš„é¢†å¯¼è€…äº§ç”Ÿçš„ã€‚æ¯ä¸ªé¢†å¯¼è€…è¢«åˆ†é…åˆ°çš„æ§½çš„é¡ºåºè¢«ç§°ä¸ºé¢†å¯¼è€…æ—¶é—´è¡¨ã€‚
Each validator selects the expected leader using the same algorithm, described below. When the validator receives a new signed ledger entry, it can be certain that an entry was produced by the expected leader. The order of slots which each leader is assigned a slot is called a leader schedule.

## é¢†å¯¼è€…è½®æ¢æ—¥ç¨‹è¡¨
## Leader Schedule Rotation#

éªŒè¯å™¨ä¼šæ‹’ç»æ²¡æœ‰æ§½ä½é¢†å¯¼è€…ç­¾åçš„å—ã€‚æ‰€æœ‰æ§½ä½é¢†å¯¼è€…çš„èº«ä»½åˆ—è¡¨è¢«ç§°ä¸ºé¢†å¯¼è€…æ—¶é—´è¡¨ã€‚é¢†å¯¼è€…æ—¥ç¨‹è¡¨æ˜¯åœ¨æœ¬åœ°å®šæœŸé‡æ–°è®¡ç®—çš„ã€‚å®ƒä¸ºæŸä¸€æ—¶é—´æ®µåˆ†é…æ§½ä½é¢†å¯¼è€…ï¼Œç§°ä¸ºçºªå…ƒã€‚æ—¶é—´è¡¨å¿…é¡»åœ¨å®ƒæ‰€åˆ†é…çš„æ§½ä½ä¹‹å‰æå‰è®¡ç®—ï¼Œè¿™æ ·å®ƒç”¨æ¥è®¡ç®—æ—¶é—´è¡¨çš„åˆ†ç±»è´¦çŠ¶æ€å°±ä¼šæœ€ç»ˆç¡®å®šã€‚è¯¥æŒç»­æ—¶é—´è¢«ç§°ä¸ºé¢†å¯¼è€…æ—¶é—´è¡¨åç§»ã€‚Solanaå°†è¯¥åç§»é‡è®¾ç½®ä¸ºç›´åˆ°ä¸‹ä¸€ä¸ªçºªå…ƒçš„æ§½çš„æŒç»­æ—¶é—´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªçºªå…ƒçš„é¢†å¯¼å‘¨æœŸæ˜¯æ ¹æ®ä¸Šä¸€ä¸ªçºªå…ƒå¼€å§‹æ—¶çš„åˆ†ç±»è´¦çŠ¶æ€è®¡ç®—çš„ã€‚ä¸€ä¸ªçºªå…ƒçš„åç§»é‡æ˜¯ç›¸å½“éšæ„çš„ï¼Œå¹¶å‡å®šå…¶è¶³å¤Ÿé•¿ï¼Œä»¥ä¾¿æ‰€æœ‰éªŒè¯è€…åœ¨ç”Ÿæˆä¸‹ä¸€ä¸ªæ—¶é—´è¡¨ä¹‹å‰å®Œæˆå…¶åˆ†ç±»è´¦çŠ¶æ€ã€‚ä¸€ä¸ªé›†ç¾¤å¯ä»¥é€‰æ‹©ç¼©çŸ­åç§»é‡ï¼Œä»¥å‡å°‘è‚¡æƒå˜åŠ¨å’Œé¢†å¯¼è€…æ—¶é—´è¡¨æ›´æ–°ä¹‹é—´çš„æ—¶é—´ã€‚
A validator rejects blocks that are not signed by the slot leader. The list of identities of all slot leaders is called a leader schedule. The leader schedule is recomputed locally and periodically. It assigns slot leaders for a duration of time called an epoch. The schedule must be computed far in advance of the slots it assigns, such that the ledger state it uses to compute the schedule is finalized. That duration is called the leader schedule offset. Solana sets the offset to the duration of slots until the next epoch. That is, the leader schedule for an epoch is calculated from the ledger state at the start of the previous epoch. The offset of one epoch is fairly arbitrary and assumed to be sufficiently long such that all validators will have finalized their ledger state before the next schedule is generated. A cluster may choose to shorten the offset to reduce the time between stake changes and leader schedule updates.

åœ¨æ²¡æœ‰æŒç»­æ—¶é—´è¶…è¿‡ä¸€ä¸ªçºªå…ƒçš„åˆ†åŒºçš„æƒ…å†µä¸‹ï¼Œåªæœ‰å½“æ ¹åˆ†å‰è·¨è¶Šçºªå…ƒè¾¹ç•Œæ—¶æ‰éœ€è¦ç”Ÿæˆæ—¶é—´è¡¨ã€‚ç”±äºæ—¶é—´è¡¨æ˜¯é’ˆå¯¹ä¸‹ä¸€ä¸ªçºªå…ƒçš„ï¼Œæ‰€ä»¥ä»»ä½•æ–°çš„è´¨æŠ¼æäº¤ç»™rootçš„forkåœ¨ä¸‹ä¸€ä¸ªçºªå…ƒä¹‹å‰ä¸ä¼šè¢«æ¿€æ´»ã€‚ç”¨äºç”Ÿæˆé¢†å¯¼æ—¶é—´è¡¨çš„åŒºå—æ˜¯ç¬¬ä¸€ä¸ªè·¨è¶Šçºªå…ƒè¾¹ç•Œçš„åŒºå—ã€‚

While operating without partitions lasting longer than an epoch, the schedule only needs to be generated when the root fork crosses the epoch boundary. Since the schedule is for the next epoch, any new stakes committed to the root fork will not be active until the next epoch. The block used for generating the leader schedule is the first block to cross the epoch boundary.

å¦‚æœæ²¡æœ‰ä¸€ä¸ªæŒç»­æ—¶é—´è¶…è¿‡ä¸€ä¸ªçºªå…ƒçš„åˆ†åŒºï¼Œé›†ç¾¤å°†æŒ‰å¦‚ä¸‹æ–¹å¼å·¥ä½œã€‚
Without a partition lasting longer than an epoch, the cluster will work as follows:

1. ä¸€ä¸ªéªŒè¯è€…åœ¨æŠ•ç¥¨æ—¶æŒç»­æ›´æ–°è‡ªå·±çš„æ ¹å‰ã€‚    
1. A validator continuously updates its own root fork as it votes.
2. éªŒè¯è€…åœ¨æ¯æ¬¡sloté«˜è¶Šè¿‡çºªå…ƒè¾¹ç•Œæ—¶ï¼Œéƒ½ä¼šæ›´æ–°å…¶é¢†å¯¼æ—¥ç¨‹è¡¨ã€‚
2. The validator updates its leader schedule each time the slot height crosses an epoch boundary.

ä¸¾ä¸ªä¾‹å­:

è®©æˆ‘ä»¬å‡è®¾çºªå…ƒå‘¨æœŸä¸º100ä¸ªslotï¼Œåœ¨ç°å®ä¸­è¿™ä¸€æ•°å­—è¦é«˜å¾—å¤šã€‚forkå®Œæˆè®¡ç®—çš„sloté«˜åº¦åœ¨ä»99æ›´æ–°åˆ°102æ—¶ä¼šæ›´æ–°root fork.å…¶ä¸­slotçš„100å’Œ101é«˜åº¦ä¼šå› ä¸ºå¤±è´¥äºŒå€è·³è¿‡.æ–°çš„é¢†å¯¼è€…å‘¨æœŸæ˜¯åœ¨sloté«˜åº¦ä¸º102çš„forkä¸Šè¿›è¡Œè®¡ç®—.æ–°çš„é¢†å¯¼è€…ä¼šåœ¨sloté«˜åº¦200çš„åœ°æ–¹å¼€å§‹æ´»åŠ¨,ç›´åˆ°å†æ¬¡è¢«æ›´æ–°.
Let's assume an epoch duration of 100 slots, which in reality is magnitudes higher. The root fork is updated from fork computed at slot height 99 to a fork computed at slot height 102. Forks with slots at height 100, 101 were skipped because of failures. The new leader schedule is computed using fork at slot height 102. It is active from slot 200 until it is updated again.

ä¸å¯èƒ½å­˜åœ¨ä¸ä¸€è‡´çš„æƒ…å†µï¼Œå› ä¸ºæ¯ä¸ªä¸é›†ç¾¤ä¸€èµ·æŠ•ç¥¨çš„éªŒè¯è€…åœ¨å…¶æ ¹éƒ¨é€šè¿‡102æ—¶éƒ½è·³è¿‡äº†100å’Œ101ã€‚æ‰€æœ‰çš„éªŒè¯è€…ï¼Œæ— è®ºå…¶æŠ•ç¥¨æ¨¡å¼å¦‚ä½•ï¼Œéƒ½ä¼šæ‰¿è¯ºå…¶æ ¹æ˜¯102ï¼Œæˆ–è€…æ˜¯102çš„å­å­™ã€‚
No inconsistency can exist because every validator that is voting with the cluster has skipped 100 and 101 when its root passes 102. All validators, 
regardless of voting pattern, would be committing to a root that is either 102, or a descendant of 102.


## é¢†å¯¼è€…è½®æ¢æ—¥ç¨‹è¡¨å’Œçºªå…ƒç­‰çº§çš„åˆ†åŒº
## Leader Schedule Rotation with Epoch Sized Partitions.#
é¢†å¯¼è€…çš„æ—¥ç¨‹åç§»çš„æŒç»­æ—¶é—´å’Œé›†ç¾¤å¯¹æ­£ç¡®çš„é¢†å¯¼è€…æ—¥ç¨‹è¡¨çœ‹æ³•ä¸ä¸€è‡´æœ‰ç€ç›´æ¥çš„å…³ç³».
The duration of the leader schedule offset has a direct relationship to the likelihood of a cluster having an inconsistent view of the correct leader schedule.

è€ƒè™‘ä¸€ä¸‹çš„æƒ…å†µ
Consider the following scenario:

ä¸¤ä¸ªåˆ†åŒºä¸ªå­—äº§ç”Ÿä¸€åŠçš„åŒºå—.ä¸¤è€…éƒ½æ²¡æœ‰è¾¾åˆ°å®šä¹‰çš„è¶…çº§å¤šæ•°åˆ†å‰.ä¸¤è€…éƒ½èƒ½å°†è·¨è¶Šçºªå…ƒ100å’Œ200,ä½†æ²¡æœ‰å®é™…æ‰¿è¯ºåˆ°ä¸€ä¸ªæ ¹ä¸Š,å› æ­¤ä¹Ÿæ²¡æœ‰åœ¨æ•´ä¸ªé›†ç¾¤ä¸­å¾—å‡ºä¸€ä¸ªæ–°çš„é¢†å¯¼è€…æ—¥ç¨‹è¡¨.
Two partitions that are generating half of the blocks each. Neither is coming to a definitive supermajority fork. Both will cross epoch 100 and 200 without actually committing to a root and therefore a cluster-wide commitment to a new leader schedule.

åœ¨è¿™ç§ä¸ç¨³å®šçš„æƒ…å†µä¸‹,å­˜åœ¨å¤šä¸ªæœ‰æ•ˆçš„é¢†å¯¼è€…æ—¥ç¨‹è¡¨.
In this unstable scenario, multiple valid leader schedules exist.

1. æ¯ä¸ªåˆ†å‰å£°ç§°ä¸€ä¸ªé¢†å¯¼è€…æ—¥ç¨‹è¡¨,å…¶ç›´æ¥çš„çˆ¶è¾ˆåœ¨ä¸Šä¸€ä¸ªçºªå…ƒ.
2. åœ¨ä¸‹ä¸€ä¸ªçºªå…ƒå¼€å§‹å,é¢†å¯¼è€…æ—¥ç¨‹è¡¨å¯¹åç»­çš„åˆ†å‰ä¾ç„¶æœ‰æ•ˆ,ç›´åˆ°å®ƒè¢«æ›´æ–°.

1. A leader schedule is generated for every fork whose direct parent is in the previous epoch.
2. The leader schedule is valid after the start of the next epoch for descendant forks until it is updated.

åœ¨åˆ†åŒºæŒç»­æ—¶é—´è¶…è¿‡ä¸€ä¸ªçºªå…ƒåï¼Œæ¯ä¸ªåˆ†åŒºçš„æ—¶é—´è¡¨å°†å‘ç”Ÿåˆ†æ­§ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œåº”é€‰æ‹©çºªå…ƒæŒç»­æ—¶é—´ï¼Œä½¿å…¶è¿œè¿œå¤§äºæ§½æ—¶é—´å’Œä¸€ä¸ªåˆ†å‰è¢«æäº¤ç»™æ ¹çš„é¢„æœŸé•¿åº¦ã€‚
Each partition's schedule will diverge after the partition lasts more than an epoch. For this reason, the epoch duration should be selected to be much much larger then slot time and the expected length for a fork to be committed to root.

åœ¨å¯¹é›†ç¾¤è§‚å¯Ÿäº†è¶³å¤Ÿé•¿çš„æ—¶é—´åï¼Œå¯ä»¥æ ¹æ®åˆ†åŒºæŒç»­æ—¶é—´çš„ä¸­ä½æ•°åŠå…¶æ ‡å‡†åå·®æ¥é€‰æ‹©é¢†å¯¼è€…çš„æ—¥ç¨‹è¡¨åç§»ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ¯”åˆ†åŒºæŒç»­æ—¶é—´ä¸­ä½æ•°é•¿çš„åç§»é‡åŠ ä¸Šå…­ä¸ªæ ‡å‡†å·®ï¼Œå°†ä½¿é›†ç¾¤ä¸­å‡ºç°ä¸ä¸€è‡´çš„åˆ†è´¦çš„å¯èƒ½æ€§é™ä½åˆ°100ä¸‡åˆ†ä¹‹ä¸€ã€‚
After observing the cluster for a sufficient amount of time, the leader schedule offset can be selected based on the median partition duration and its standard deviation. For example, an offset longer then the median partition duration plus six standard deviations would reduce the likelihood of an inconsistent ledger schedule in the cluster to 1 in 1 million.

## åœ¨åˆ›ä¸–çºªå£°ç§°é¢†å¯¼è€…æ—¥ç¨‹è¡¨.
## Leader Schedule Generation at Genesis#

åˆ›ä¸–é…ç½®å®£å¸ƒäº†ç¬¬ä¸€ä¸ªçºªå…ƒçš„ç¬¬ä¸€ä¸ªé¢†å¯¼è€….è¿™ä¸ªé¢†å¯¼è€…æœ€ç»ˆä¼šè¢«å®‰æ’åœ¨å‰ä¸¤ä¸ªçºªå…ƒï¼Œå› ä¸ºé¢†å¯¼è€…æ—¶é—´è¡¨ä¹Ÿæ˜¯åœ¨0æ§½ç”Ÿæˆçš„ï¼Œç”¨äºä¸‹ä¸€ä¸ªçºªå…ƒã€‚å‰ä¸¤ä¸ªçºªå…ƒçš„é•¿åº¦ä¹Ÿå¯ä»¥åœ¨genesis configä¸­æŒ‡å®šã€‚ç¬¬ä¸€ä¸ªçºªå…ƒçš„æœ€å°é•¿åº¦å¿…é¡»å¤§äºæˆ–ç­‰äºå¡”tower BFTä¸­å®šä¹‰çš„æœ€å¤§å›æ»šæ·±åº¦ã€‚

The genesis config declares the first leader for the first epoch. This leader ends up scheduled for the first two epochs because the leader schedule is also generated at slot 0 for the next epoch. The length of the first two epochs can be specified in the genesis config as well. The minimum length of the first epochs must be greater than or equal to the maximum rollback depth as defined in Tower BFT.

## é¢†å¯¼æ—¥ç¨‹è¡¨ç”Ÿæˆç®—æ³•
## Leader Schedule Generation Algorithm#

é¢†å¯¼è€…æ—¥ç¨‹è¡¨æ˜¯ç”¨é¢„å…ˆè®¾å®šçš„ç§å­ç”Ÿæˆçš„,å…¶æµç¨‹å¦‚ä¸‹:
Leader schedule is generated using a predefined seed. The process is as follows:

1. å®šæœŸä½¿ç”¨PoH tické«˜åº¦ï¼ˆä¸€ä¸ªå•è°ƒå¢åŠ çš„è®¡æ•°å™¨ï¼‰æ¥ä½œä¸ºç¨³å®šçš„ä¼ªéšæœºç®—æ³•çš„ç§å­ã€‚
2. åœ¨è¯¥é«˜åº¦ï¼Œå¯¹é“¶è¡Œä¸­æ‰€æœ‰åœ¨é›†ç¾¤é…ç½®çš„tickæ•°å†…æŠ•è¿‡ç¥¨çš„å…·æœ‰é¢†å¯¼èº«ä»½çš„è¢«æŠ¼è´¦æˆ·è¿›è¡ŒæŠ½æ ·ã€‚è¿™ä¸ªæ ·æœ¬è¢«ç§°ä¸ºæ´»åŠ¨é›†.
3. æŒ‰ç…§è´¨æŠ¼çš„æ¯”é‡å¯¹æ´»è·ƒé›†åˆè¿›è¡Œæ’åº
4. ä½¿ç”¨éšæœºç§å­æ¥é€‰æ‹©æŒ‰è´¨æŠ¼åŠ æƒçš„èŠ‚ç‚¹ï¼Œä»¥åˆ›å»ºä¸€ä¸ªè´¨æŠ¼åŠ æƒçš„æ’åºã€‚
5. è¿™ä¸ªæ’åºåœ¨é›†ç¾¤é…ç½®tickæ•°ç›®åæœ‰æ•ˆ

è‹±æ–‡:

1. Periodically use the PoH tick height (a monotonically increasing counter) to seed a stable pseudo-random algorithm.
2. At that height, sample the bank for all the staked accounts with leader identities that have voted within a cluster-configured number of ticks. The sample is called the active set.
3. Sort the active set by stake weight.
4. Use the random seed to select nodes weighted by stake to create a stake-weighted ordering.
5. This ordering becomes valid after a cluster-configured number of ticks.

## æ—¥ç¨‹è¡¨æ”»å‡»çš„å› ç´ 
## Schedule Attack Vectors#

### ç§å­
### Seed#
é€‰æ‹©çš„ç§å­æ˜¯å¯é¢„æµ‹çš„ä½†ä¸å¯åå‘. æ²¡æœ‰æ¨æ•²æ”»å‡»å¸¦æ¥çš„å½±å“.
The seed that is selected is predictable but unbiasable. There is no grinding attack to influence its outcome.

### æ´»åŠ¨é›†
### Active Set#

é¢†å¯¼è€…å¯ä»¥é€šè¿‡å®¡æŸ¥éªŒè¯è€…çš„æŠ•ç¥¨æ¥åè¢’æ´»åŠ¨é›†.é¢†å¯¼è€…å¯èƒ½æœ‰ä¸¤ç§æ–¹æ³•æ¥å®¡æŸ¥æ´»åŠ¨é›†.
A leader can bias the active set by censoring validator votes. Two possible ways exist for leaders to censor the active set:

1. å¿½ç•¥éªŒè¯è€…çš„æŠ•ç¥¨
2. æ‹’ç»ä¸ºæœ‰éªŒè¯è€…æŠ•ç¥¨çš„åŒºå—è¿›è¡ŒæŠ•ç¥¨

è‹±æ–‡:
1. Ignore votes from validators
2. Refuse to vote for blocks with votes from validators

ä¸ºäº†å‡å°‘å®¡æŸ¥çš„å¯èƒ½æ€§ï¼Œæ´»åŠ¨é›†æ˜¯åœ¨æ´»åŠ¨é›†æŠ½æ ·æŒç»­æ—¶é—´å†…ï¼Œåœ¨é¢†å¯¼è€…æ—¥ç¨‹è¡¨åç§»è¾¹ç•Œè®¡ç®—çš„ã€‚æ´»åŠ¨é›†æŠ½æ ·æŒç»­æ—¶é—´è¶³å¤Ÿé•¿ï¼Œä»¥ä¾¿å¤šä¸ªé¢†å¯¼è€…éƒ½èƒ½æ”¶é›†åˆ°æŠ•ç¥¨ã€‚

To reduce the likelihood of censorship, the active set is calculated at the leader schedule offset boundary over an active set sampling duration. The active set sampling duration is long enough such that votes will have been collected by multiple leaders.

## è´¨æŠ¼
## Staking#
é¢†å¯¼è€…å¯ä»¥å®¡æŸ¥æ–°çš„è´¨æŠ¼äº¤æ˜“æˆ–æ‹’ç»éªŒè¯æœ‰æ–°è´¨æŠ¼çš„åŒºå—ã€‚è¿™ç§æ”»å‡»ç±»ä¼¼äºå¯¹éªŒè¯è€…æŠ•ç¥¨æƒçš„å®¡æŸ¥ã€‚
Leaders can censor new staking transactions or refuse to validate blocks with new stakes. This attack is similar to censorship of validator votes.

## éªŒè¯è€…æ“ä½œå¯†é’¥ä¸¢å¤±
## Validator operational key loss#

é¢†å¯¼è€…å’ŒéªŒè¯è€…åº”è¯¥ä½¿ç”¨çŸ­æš‚çš„å¯†é’¥è¿›è¡Œæ“ä½œï¼Œè‚¡æƒæ‰€æœ‰è€…é€šè¿‡å§”æ‰˜æˆæƒéªŒè¯è€…å¯¹å…¶è‚¡æƒè¿›è¡Œå·¥ä½œã€‚

Leaders and validators are expected to use ephemeral keys for operation, and stake owners authorize the validators to do work with their stake via delegation.

é›†ç¾¤åº”è¯¥èƒ½å¤Ÿä»é¢†å¯¼è€…å’ŒéªŒè¯è€…ä½¿ç”¨çš„æ‰€æœ‰çŸ­æš‚å¯†é’¥çš„ä¸¢å¤±ä¸­æ¢å¤ï¼Œè¿™å¯èƒ½æ˜¯é€šè¿‡æ‰€æœ‰èŠ‚ç‚¹å…±äº«çš„å…±åŒè½¯ä»¶æ¼æ´å‘ç”Ÿçš„ã€‚åˆ©ç›Šç›¸å…³è€…åº”è¯¥èƒ½å¤Ÿé€šè¿‡å…±åŒç­¾ç½²éªŒè¯äººçš„æŠ•ç¥¨æ¥ç›´æ¥æŠ•ç¥¨ï¼Œå³ä½¿è¯¥åˆ©ç›Šç›¸å…³è€…ç›®å‰è¢«å§”æ‰˜ç»™éªŒè¯è€…ã€‚
The cluster should be able to recover from the loss of all the ephemeral keys used by leaders and validators, which could occur through a common software vulnerability shared by all the nodes. Stake owners should be able to vote directly by co-signing a validator vote even though the stake is currently delegated to a validator.

## è¿½åŠ æ¡ç›®
## Appending Entries

ä¸€ä¸ªé¢†å¯¼è€…æ—¶é—´è¡¨çš„å¯¿å‘½è¢«ç§°ä¸ºä¸€ä¸ªçºªå…ƒã€‚çºªå…ƒè¢«åˆ†å‰²æˆè‹¥å¹²æ—¶æ®µï¼Œæ¯ä¸ªæ—¶æ®µçš„æŒç»­æ—¶é—´ä¸ºT PoH ticksã€‚
The lifetime of a leader schedule is called an epoch. The epoch is split into slots, where each slot has a duration of T PoH ticks.

ä¸€ä¸ªé¢†å¯¼è€…åœ¨å…¶æ—¶æ®µå†…ä¼ è¾“æ¡ç›®ã€‚åœ¨Tåˆ»åº¦ä¹‹åï¼Œæ‰€æœ‰éªŒè¯è€…éƒ½åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªé¢„å®šçš„é¢†å¯¼è€…ã€‚éªŒè¯è€…å¿…é¡»å¿½ç•¥åœ¨é¢†å¯¼è€…åˆ†é…çš„æ—¶æ®µä¹‹å¤–å‘é€çš„æ¡ç›®ã€‚
A leader transmits entries during its slot. After T ticks, all the validators switch to the next scheduled leader. Validators must ignore entries sent outside a leader's assigned slot.

ä¸‹ä¸€ä¸ªé¢†å¯¼è€…å¿…é¡»è§‚å¯Ÿåˆ°æ‰€æœ‰çš„Ticksï¼Œä»¥ä¾¿å®ƒå»ºç«‹è‡ªå·±çš„æ¡ç›®ã€‚å¦‚æœæ²¡æœ‰è§‚å¯Ÿåˆ°æ¡ç›®ï¼ˆé¢†å¤´ç¾Šå€’ä¸‹äº†ï¼‰æˆ–è€…æ¡ç›®æ— æ•ˆï¼ˆé¢†å¤´ç¾Šæœ‰é—®é¢˜æˆ–è€…æ˜¯æ¶æ„çš„ï¼‰ï¼Œä¸‹ä¸€ä¸ªé¢†å¤´ç¾Šå¿…é¡»äº§ç”Ÿticksæ¥å¡«è¡¥ä¸Šä¸€ä¸ªé¢†å¤´ç¾Šçš„æ§½ã€‚è¯·æ³¨æ„ï¼Œä¸‹ä¸€ä¸ªé¢†å¯¼è€…åº”è¯¥å¹³è¡Œåœ°è¿›è¡Œä¿®å¤è¯·æ±‚ï¼Œå¹¶æ¨è¿Ÿå‘é€ticksï¼Œç›´åˆ°å®ƒç¡®ä¿¡å…¶ä»–éªŒè¯è€…ä¹Ÿæœªèƒ½è§‚å¯Ÿåˆ°å‰ä¸€ä¸ªé¢†å¯¼è€…çš„æ¡ç›®ã€‚å¦‚æœä¸€ä¸ªé¢†å¯¼è€…é”™è¯¯åœ°å»ºç«‹åœ¨è‡ªå·±çš„å°æ•°ç‚¹ä¸Šï¼Œç´§éšå…¶åçš„é¢†å¯¼è€…å¿…é¡»æ›¿æ¢å…¶æ‰€æœ‰å°æ•°ç‚¹ã€‚
All T ticks must be observed by the next leader for it to build its own entries on. If entries are not observed (leader is down) or entries are invalid (leader is buggy or malicious), the next leader must produce ticks to fill the previous leader's slot. Note that the next leader should do repair requests in parallel, and postpone sending ticks until it is confident other validators also failed to observe the previous leader's entries. If a leader incorrectly builds on its own ticks, the leader following it must replace all its ticks.

## åˆ†å‰ç”Ÿæˆ
## Fork Generation
æœ¬èŠ‚æè¿°äº†ä½œä¸ºé¢†å¯¼è€…è½®æ¢çš„ç»“æœ, åˆ†å‰æ˜¯å¦‚ä½•è‡ªç„¶å‘ç”Ÿçš„ã€‚
This section describes how forks naturally occur as a consequence of leader rotation.

### æ¦‚è¿°
### Overview

èŠ‚ç‚¹è½®æµæ‹…ä»»é¢†å¯¼è€…å¹¶ç”Ÿæˆç¼–ç çŠ¶æ€å˜åŒ–çš„PoHã€‚é›†ç¾¤å¯ä»¥é€šè¿‡åˆæˆé¢†å¯¼è€…åœ¨è¿æ¥çš„æƒ…å†µä¸‹ä¼šäº§ç”Ÿçš„ä¸œè¥¿æ¥å®¹å¿ä¸ä»»ä½•é¢†å¯¼è€…çš„å¤±è”ï¼Œä½†ä¸æ‘„å–ä»»ä½•çŠ¶æ€å˜åŒ–ã€‚å› æ­¤ï¼Œåˆ†å‰çš„å¯èƒ½æ•°é‡è¢«é™åˆ¶åœ¨ä¸€ä¸ª "æœ‰/æ—  "åˆ†å‰çš„è·³è¿‡åˆ—è¡¨ä¸­ï¼Œè¿™äº›åˆ†å‰å¯èƒ½å‡ºç°åœ¨é¢†å¯¼è€…æ—‹è½¬æ§½çš„è¾¹ç•Œã€‚åœ¨ä»»ä½•ç»™å®šçš„æ—¶æ®µï¼Œåªæœ‰ä¸€ä¸ªé¢†å¯¼è€…çš„äº‹åŠ¡ä¼šè¢«æ¥å—ã€‚
Nodes take turns being leader and generating the PoH that encodes state changes. The cluster can tolerate loss of connection to any leader by synthesizing what the leader would have generated had it been connected but not ingesting any state changes. The possible number of forks is thereby limited to a "there/not-there" skip list of forks that may arise on leader rotation slot boundaries. At any given slot, only a single leader's transactions will be accepted.

### ä¿¡æ¯æµ
### Message Flow
1. äº¤æ˜“ç”±å½“å‰é¢†å¯¼è€…æ¥æ”¶ã€‚
2. é¢†å¯¼è€…è¿‡æ»¤æœ‰æ•ˆçš„äº¤æ˜“ã€‚
3. é¢†å¯¼è€…æ‰§è¡Œæœ‰æ•ˆçš„äº¤æ˜“ï¼Œæ›´æ–°å…¶çŠ¶æ€ã€‚
4. é¢†å¯¼è€…æ ¹æ®å…¶å½“å‰çš„PoHæ§½å°†äº¤æ˜“æ‰“åŒ…æˆæ¡ç›®ã€‚
5. é¢†å¯¼è€…å°†æ¡ç›®ä¼ é€ç»™éªŒè¯è€…èŠ‚ç‚¹ï¼ˆä»¥ç­¾åçš„ç¢ç‰‡å½¢å¼ï¼‰ã€‚
    1. PoHæµåŒ…æ‹¬ticks,ç©ºæ¡ç›®ï¼Œè¡¨ç¤ºé¢†å¯¼è€…çš„æœ‰æ•ˆæ€§å’Œé›†ç¾¤ä¸Šçš„æ—¶é—´æµé€ã€‚
    2. é¢†å¯¼è€…çš„æ•°æ®æµä»å®ŒæˆPoHæ‰€éœ€çš„tickæ¡ç›®å¼€å§‹ï¼Œå›åˆ°é¢†å¯¼è€…æœ€è¿‘è§‚å¯Ÿåˆ°çš„å‰ä¸€ä¸ªé¢†å¯¼è€…æ—¶æ®µã€‚
6. éªŒè¯è€…å‘å…¶é›†åˆä¸­çš„å¯¹ç­‰ä½“å’Œè¿›ä¸€æ­¥çš„ä¸‹æ¸¸èŠ‚ç‚¹é‡æ–°ä¼ é€æ¡ç›®ã€‚
7. éªŒè¯è€…éªŒè¯äº¤æ˜“å¹¶åœ¨å…¶çŠ¶æ€ä¸Šæ‰§è¡Œã€‚
8. éªŒè¯è€…è®¡ç®—çŠ¶æ€çš„å“ˆå¸Œå€¼ã€‚
9. åœ¨ç‰¹å®šçš„æ—¶é—´ï¼Œå³ç‰¹å®šçš„PoH tickè®¡æ•°ï¼ŒéªŒè¯è€…å‘é¢†å¯¼è€…å‘é€æŠ•ç¥¨ã€‚
    1. æŠ•ç¥¨æ˜¯è¯¥PoH tickè®¡æ•°æ—¶è®¡ç®—å‡ºçš„çŠ¶æ€çš„å“ˆå¸Œå€¼çš„ç­¾åã€‚
    2. æŠ•ç¥¨ä¹Ÿæ˜¯é€šè¿‡gossipåè®®ä¼ æ’­çš„ã€‚
10. é¢†å¯¼è€…æ‰§è¡ŒæŠ•ç¥¨ï¼Œä¸å…¶ä»–äº¤æ˜“ä¸€æ ·ï¼Œå¹¶å°†å…¶å¹¿æ’­ç»™é›†ç¾¤ã€‚
11. éªŒè¯è€…è§‚å¯Ÿä»–ä»¬çš„æŠ•ç¥¨å’Œé›†ç¾¤ä¸­çš„æ‰€æœ‰æŠ•ç¥¨ã€‚

è‹±æ–‡:
1. Transactions are ingested by the current leader.
2. Leader filters valid transactions.
3. Leader executes valid transactions updating its state.
4. Leader packages transactions into entries based off its current PoH slot.
5. Leader transmits the entries to validator nodes (in signed shreds)
    1. The PoH stream includes ticks; empty entries that indicate liveness of the leader and the passage of time on the cluster.
    2. A leader's stream begins with the tick entries necessary to complete PoH back to the leader's most recently observed prior leader slot.
6. Validators retransmit entries to peers in their set and to further downstream nodes.
7. Validators validate the transactions and execute them on their state.
8. Validators compute the hash of the state.
9. At specific times, i.e. specific PoH tick counts, validators transmit votes to the leader.
    1. Votes are signatures of the hash of the computed state at that PoH tick count.
    2. Votes are also propagated via gossip.
10. Leader executes the votes, the same as any other transaction, and broadcasts them to the cluster.
11. Validators observe their votes and all the votes from the cluster.

### åˆ†åŒºï¼Œåˆ†å‰
### Partitions, Forks#

åœ¨å¯¹åº”äºæŠ•ç¥¨çš„PoH tickè®¡æ•°æ—¶ï¼Œä¼šå‡ºç°åˆ†å‰ã€‚ä¸‹ä¸€ä¸ªé¢†å¯¼è€…å¯èƒ½æ²¡æœ‰è§‚å¯Ÿåˆ°æœ€åä¸€ä¸ªæŠ•ç¥¨æ—¶æ®µï¼Œå¹¶å¯èƒ½ä»¥ç”Ÿæˆçš„è™šæ‹ŸPoHæ¡ç›®å¼€å§‹ä»–ä»¬çš„æ—¶æ®µã€‚è¿™äº›ç©ºtickæ˜¯ç”±é›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ä»¥é›†ç¾¤é…ç½®çš„hash/per/tick Zçš„é€Ÿç‡ç”Ÿæˆçš„ã€‚
Forks can arise at PoH tick counts that correspond to a vote. The next leader may not have observed the last vote slot and may start their slot with generated virtual PoH entries. These empty ticks are generated by all nodes in the cluster at a cluster-configured rate for hashes/per/tick Z.

åœ¨ä¸€ä¸ªæŠ•ç¥¨æ—¶æ®µï¼Œåªæœ‰ä¸¤ç§å¯èƒ½çš„PoHç‰ˆæœ¬ã€‚å«æœ‰Tåˆ»åº¦å’Œç”±å½“å‰é¢†å¯¼è€…äº§ç”Ÿçš„æ¡ç›®çš„PoHï¼Œæˆ–è€…åªæœ‰åˆ»åº¦çš„PoHã€‚PoHçš„ "ä»…æœ‰åˆ»åº¦ "ç‰ˆæœ¬å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªè™šæ‹Ÿè´¦æœ¬ï¼Œé›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½å¯ä»¥ä»ä¸Šä¸€ä¸ªæ—¶æ®µçš„æœ€åä¸€ä¸ªåˆ»åº¦ä¸­å¾—å‡ºã€‚
There are only two possible versions of the PoH during a voting slot: PoH with T ticks and entries generated by the current leader, or PoH with just ticks. The "just ticks" version of the PoH can be thought of as a virtual ledger, one that all nodes in the cluster can derive from the last tick in the previous slot.

éªŒè¯è€…å¯ä»¥å¿½ç•¥å…¶ä»–ç‚¹çš„åˆ†å‰ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ªé”™è¯¯çš„é¢†å¯¼è€…ï¼‰ï¼Œæˆ–è€…ç æ‰è´Ÿè´£åˆ†å‰çš„é¢†å¯¼è€…ã€‚
Validators can ignore forks at other points (e.g. from the wrong leader), or slash the leader responsible for the fork.

éªŒè¯è€…åŸºäºè´ªå©ªçš„é€‰æ‹©è¿›è¡ŒæŠ•ç¥¨ï¼Œä»¥æœ€å¤§åŒ–ä»–ä»¬åœ¨Tower BFTä¸­æè¿°çš„å¥–åŠ±ã€‚
Validators vote based on a greedy choice to maximize their reward described in Tower BFT.

### ç®¡ç†åˆ†å‰
### Managing Forks
è´¦æœ¬è¢«å…è®¸åœ¨æ§½çš„è¾¹ç•Œå¤„åˆ†å‰ã€‚ç”±æ­¤äº§ç”Ÿçš„æ•°æ®ç»“æ„å½¢æˆä¸€æ£µæ ‘ï¼Œç§°ä¸ºblockstoreã€‚å½“éªŒè¯å™¨è§£é‡ŠåŒºå—å­˜å‚¨æ—¶ï¼Œå®ƒå¿…é¡»ä¸ºé“¾ä¸Šçš„æ¯ä¸ªåˆ†å‰ç»´æŒçŠ¶æ€ã€‚æˆ‘ä»¬ç§°æ¯ä¸ªå®ä¾‹ä¸ºæ´»åŠ¨åˆ†å‰ã€‚éªŒè¯å™¨çš„è´£ä»»æ˜¯æƒè¡¡è¿™äº›åˆ†å‰ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥æœ€ç»ˆé€‰æ‹©ä¸€ä¸ªåˆ†å‰ã€‚
The ledger is permitted to fork at slot boundaries. The resulting data structure forms a tree called a blockstore. When the validator interprets the blockstore, it must maintain state for each fork in the chain. We call each instance an active fork. It is the responsibility of a validator to weigh those forks, such that it may eventually select a fork.

éªŒè¯è€…é€šè¿‡å‘è¯¥åˆ†å‰çš„æ§½ä½é¢†å¯¼è€…æäº¤æŠ•ç¥¨æ¥é€‰æ‹©ä¸€ä¸ªåˆ†å‰ã€‚è¯¥æŠ•ç¥¨ä½¿éªŒè¯è€…åœ¨ä¸€å®šæ—¶é—´å†…æ‰¿è¯ºï¼Œç§°ä¸ºé”å®šæœŸã€‚åœ¨é”å®šæœŸç»“æŸä¹‹å‰ï¼ŒéªŒè¯äººä¸å…è®¸åœ¨ä¸åŒçš„åˆ†å‰ä¸ŠæŠ•ç¥¨ã€‚åœ¨åŒä¸€åˆ†å‰ä¸Šçš„æ¯ä¸€æ¬¡åç»­æŠ•ç¥¨éƒ½ä¼šä½¿é”å®šæœŸçš„é•¿åº¦å¢åŠ ä¸€å€ã€‚åœ¨æŸä¸ªé›†ç¾¤é…ç½®çš„æŠ•ç¥¨æ•°ï¼ˆç›®å‰æ˜¯32ï¼‰ä¹‹åï¼Œé”å®šæœŸçš„é•¿åº¦è¾¾åˆ°æ‰€è°“çš„æœ€å¤§é”å®šã€‚åœ¨è¾¾åˆ°æœ€å¤§é”å®šæœŸä¹‹å‰ï¼ŒéªŒè¯è€…å¯ä»¥é€‰æ‹©ç­‰å¾…ï¼Œç›´åˆ°é”å®šæœŸç»“æŸï¼Œç„¶ååœ¨å¦ä¸€ä¸ªåˆ†å‰ä¸ŠæŠ•ç¥¨ã€‚å½“å®ƒåœ¨å¦ä¸€ä¸ªåˆ†å‰ä¸ŠæŠ•ç¥¨æ—¶ï¼Œå®ƒæ‰§è¡Œä¸€ä¸ªå«åšå›æ»šçš„æ“ä½œï¼Œå³çŠ¶æ€åœ¨æ—¶é—´ä¸Šå›æ»šåˆ°ä¸€ä¸ªå…±äº«çš„æ£€æŸ¥ç‚¹ï¼Œç„¶åå‘å‰è·³åˆ°å®ƒåˆšåˆšæŠ•ç¥¨çš„åˆ†å‰çš„é¡¶ç«¯ã€‚ä¸€ä¸ªåˆ†å‰å¯ä»¥å›æ»šçš„æœ€å¤§è·ç¦»è¢«ç§°ä¸ºå›æ»šæ·±åº¦ã€‚å›æ»šæ·±åº¦æ˜¯å®ç°æœ€å¤§é”å®šæ‰€éœ€çš„æŠ•ç¥¨æ•°é‡ã€‚æ¯å½“éªŒè¯è€…æŠ•ç¥¨æ—¶ï¼Œä»»ä½•è¶…å‡ºå›æ»šæ·±åº¦çš„æ£€æŸ¥ç‚¹éƒ½å˜å¾—æ— æ³•åˆ°è¾¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å­˜åœ¨éªŒè¯å™¨éœ€è¦å›æ»šè¶…è¿‡å›æ»šæ·±åº¦çš„æƒ…å†µã€‚å› æ­¤ï¼Œå®ƒå¯ä»¥å®‰å…¨åœ°ä¿®å‰ªæ— æ³•åˆ°è¾¾çš„åˆ†å‰ï¼Œå¹¶å°†è¶…å‡ºå›æ»šæ·±åº¦çš„æ‰€æœ‰æ£€æŸ¥ç‚¹å‹å…¥æ ¹æ£€æŸ¥ç‚¹ã€‚
A validator selects a fork by submiting a vote to a slot leader on that fork. The vote commits the validator for a duration of time called a lockout period. The validator is not permitted to vote on a different fork until that lockout period expires. Each subsequent vote on the same fork doubles the length of the lockout period. After some cluster-configured number of votes (currently 32), the length of the lockout period reaches what's called max lockout. Until the max lockout is reached, the validator has the option to wait until the lockout period is over and then vote on another fork. When it votes on another fork, it performs an operation called rollback, whereby the state rolls back in time to a shared checkpoint and then jumps forward to the tip of the fork that it just voted on. The maximum distance that a fork may roll back is called the rollback depth. Rollback depth is the number of votes required to achieve max lockout. Whenever a validator votes, any checkpoints beyond the rollback depth become unreachable. That is, there is no scenario in which the validator will need to roll back beyond rollback depth. It therefore may safely prune unreachable forks and squash all checkpoints beyond rollback depth into the root checkpoint.

## å®‰å…¨æŠ•ç¥¨ç­¾å
## Secure Vote Signing

ä¸€ä¸ªéªŒè¯è€…ä»å½“å‰çš„é¢†å¯¼è€…é‚£é‡Œæ¥æ”¶æ¡ç›®ï¼Œå¹¶æäº¤ç¡®è®¤è¿™äº›æ¡ç›®æœ‰æ•ˆçš„æŠ•ç¥¨ã€‚è¿™ç§æŠ•ç¥¨çš„æäº¤å¸¦æ¥äº†å®‰å…¨æŒ‘æˆ˜ï¼Œå› ä¸ºè¿åå…±è¯†è§„åˆ™çš„ä¼ªé€ æŠ•ç¥¨å¯ä»¥ç”¨æ¥å‰Šå‡éªŒè¯è€…çš„è‚¡ä»½ã€‚
A validator receives entries from the current leader and submits votes confirming those entries are valid. This vote submission presents a security challenge, because forged votes that violate consensus rules could be used to slash the validator's stake.

éªŒè¯è€…é€šè¿‡æäº¤ä¸€ä¸ªäº¤æ˜“å¯¹å…¶é€‰æ‹©çš„åˆ†å‰è¿›è¡ŒæŠ•ç¥¨ï¼Œè¯¥äº¤æ˜“ä½¿ç”¨éå¯¹ç§°å¯†é’¥å¯¹å…¶éªŒè¯å·¥ä½œçš„ç»“æœè¿›è¡Œç­¾åã€‚å…¶ä»–å®ä½“å¯ä»¥ä½¿ç”¨éªŒè¯è€…çš„å…¬é’¥éªŒè¯è¿™ä¸ªç­¾åã€‚å¦‚æœéªŒè¯è€…çš„å¯†é’¥è¢«ç”¨æ¥ç­¾ç½²ä¸æ­£ç¡®çš„æ•°æ®ï¼ˆä¾‹å¦‚ï¼Œå¯¹åˆ†ç±»å¸çš„å¤šä¸ªåˆ†å‰çš„æŠ•ç¥¨ï¼‰ï¼ŒèŠ‚ç‚¹çš„è‚¡æƒæˆ–å…¶èµ„æºå¯èƒ½è¢«ç ´åã€‚
The validator votes on its chosen fork by submitting a transaction that uses an asymmetric key to sign the result of its validation work. Other entities can verify this signature using the validator's public key. If the validator's key is used to sign incorrect data (e.g. votes on multiple forks of the ledger), the node's stake or its resources could be compromised.

### éªŒè¯äººã€æŠ•ç¥¨ç­¾åäººå’Œåˆ©ç›Šç›¸å…³è€…
### Validators, Vote Signers, and Stakeholders#

å½“éªŒè¯è€…æ”¶åˆ°åŒä¸€æ—¶æ®µçš„å¤šä¸ªåŒºå—æ—¶ï¼Œå®ƒä¼šè·Ÿè¸ªæ‰€æœ‰å¯èƒ½çš„åˆ†å‰ï¼Œç›´åˆ°ç¡®å®šä¸€ä¸ª "æœ€ä½³ "çš„åˆ†å‰ã€‚éªŒè¯è€…é€šè¿‡å‘å…¶æäº¤æŠ•ç¥¨æ¥é€‰æ‹©æœ€ä½³åˆ†å‰ã€‚
When a validator receives multiple blocks for the same slot, it tracks all possible forks until it can determine a "best" one. A validator selects the best fork by submitting a vote to it.

åˆ©ç›Šç›¸å…³è€…æ˜¯ä¸€ä¸ªå¯¹æ‰€æŠ•èµ„æœ¬æ‹¥æœ‰æ§åˆ¶æƒçš„èº«ä»½ã€‚åˆ©ç›Šç›¸å…³è€…å¯ä»¥å°†å…¶è‚¡æƒå§”æ‰˜ç»™æŠ•ç¥¨ç­¾åè€…ã€‚ä¸€æ—¦è‚¡æƒè¢«å§”æ‰˜ï¼ŒæŠ•ç¥¨ç­¾åè€…çš„æŠ•ç¥¨å°±ä»£è¡¨äº†æ‰€æœ‰è¢«å§”æ‰˜çš„è‚¡æƒçš„æŠ•ç¥¨æƒé‡ï¼Œå¹¶ä¸ºæ‰€æœ‰è¢«å§”æ‰˜çš„è‚¡æƒäº§ç”Ÿå¥–åŠ±ã€‚
A stakeholder is an identity that has control of the staked capital. The stakeholder can delegate its stake to the vote signer. Once a stake is delegated, the vote signer's votes represent the voting weight of all the delegated stakes, and produce rewards for all the delegated stakes.

### éªŒè¯äººæŠ•ç¥¨
### Validator voting#
ä¸€ä¸ªéªŒè¯è€…èŠ‚ç‚¹ï¼Œåœ¨å¯åŠ¨æ—¶ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æŠ•ç¥¨è´¦æˆ·ï¼Œå¹¶é€šè¿‡æµè¨€èœšè¯­åœ¨é›†ç¾¤ä¸­æ³¨å†Œã€‚é›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹å°†æ–°çš„éªŒè¯è€…åˆ—å…¥æ´»åŠ¨é›†ã€‚éšåï¼ŒéªŒè¯äººåœ¨æ¯ä¸ªæŠ•ç¥¨äº‹ä»¶ä¸­æäº¤ä¸€ä¸ªç”¨éªŒè¯äººçš„æŠ•ç¥¨ç§é’¥ç­¾åçš„ "æ–°æŠ•ç¥¨ "äº¤æ˜“ã€‚
A validator node, at startup, creates a new vote account and registers it with the cluster via gossip. The other nodes on the cluster include the new validator in the active set. Subsequently, the validator submits a "new vote" transaction signed with the validator's voting private key on each voting event.

## Stake Delegation and Rewards